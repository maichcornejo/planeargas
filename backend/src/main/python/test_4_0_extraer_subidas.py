import os
import pytest
from _4_0_extraer_subidas_bajadas import process_geotiff_subidas

def test_extraer_subidas():

    input_file_subidas = '/home/meli/planeargas/backend/src/imagen_raster/subidas_bajadas.tif'
    output_file_subidas = '/home/meli/planeargas/backend/src/txt_resultantes/resultados_subidas_bajadas.txt'

    process_geotiff_subidas(input_file_subidas, output_file_subidas)

            # Contenido esperado del archivo generado
    contenido_esperado = """Polígono:
(5.128, -7.276)
(5.128, -7.28)
(5.132, -7.28)
(5.132, -7.276)
(5.128, -7.276)
Centroide: (5.13, -7.278)

Polígono:
(5.128, -7.284)
(5.128, -7.288)
(5.132, -7.288)
(5.132, -7.284)
(5.128, -7.284)
Centroide: (5.13, -7.286)

Polígono:
(4.596, -7.288)
(4.596, -7.292)
(4.6, -7.292)
(4.6, -7.288)
(4.596, -7.288)
Centroide: (4.598, -7.29)

Polígono:
(5.108, -7.268)
(5.108, -7.272)
(5.104, -7.272)
(5.104, -7.276)
(5.1, -7.276)
(5.1, -7.288)
(5.104, -7.288)
(5.104, -7.292)
(5.108, -7.292)
(5.108, -7.296)
(5.12, -7.296)
(5.12, -7.292)
(5.124, -7.292)
(5.124, -7.284)
(5.128, -7.284)
(5.128, -7.28)
(5.124, -7.28)
(5.124, -7.272)
(5.12, -7.272)
(5.12, -7.268)
(5.108, -7.268)
Centroide: (5.113314285714286, -7.282)

Polígono:
(5.124, -7.292)
(5.124, -7.296)
(5.128, -7.296)
(5.128, -7.292)
(5.124, -7.292)
Centroide: (5.126, -7.294)

Polígono:
(4.576, -7.272)
(4.576, -7.276)
(4.572, -7.276)
(4.572, -7.28)
(4.568, -7.28)
(4.568, -7.292)
(4.572, -7.292)
(4.572, -7.296)
(4.576, -7.296)
(4.576, -7.3)
(4.588, -7.3)
(4.588, -7.296)
(4.592, -7.296)
(4.592, -7.288)
(4.596, -7.288)
(4.596, -7.284)
(4.592, -7.284)
(4.592, -7.276)
(4.588, -7.276)
(4.588, -7.272)
(4.576, -7.272)
Centroide: (4.581314285714286, -7.286)

Polígono:
(4.568, -7.296)
(4.568, -7.3)
(4.572, -7.3)
(4.572, -7.296)
(4.568, -7.296)
Centroide: (4.57, -7.298)

Polígono:
(4.572, -7.296)
(4.572, -7.3)
(4.576, -7.3)
(4.576, -7.296)
(4.572, -7.296)
Centroide: (4.574, -7.298)

Polígono:
(4.588, -7.296)
(4.588, -7.3)
(4.592, -7.3)
(4.592, -7.296)
(4.588, -7.296)
Centroide: (4.59, -7.298)

Polígono:
(4.592, -7.296)
(4.592, -7.3)
(4.596, -7.3)
(4.596, -7.296)
(4.592, -7.296)
Centroide: (4.594, -7.298)

Polígono:
(4.572, -7.3)
(4.572, -7.304)
(4.576, -7.304)
(4.576, -7.3)
(4.572, -7.3)
Centroide: (4.574, -7.302)

Polígono:
(4.588, -7.3)
(4.588, -7.304)
(4.592, -7.304)
(4.592, -7.3)
(4.588, -7.3)
Centroide: (4.59, -7.302)

Polígono:
(5.636, -14.196)
(5.636, -14.2)
(5.64, -14.2)
(5.64, -14.196)
(5.636, -14.196)
Centroide: (5.638, -14.198)

Polígono:
(5.616, -14.18)
(5.616, -14.184)
(5.612, -14.184)
(5.612, -14.188)
(5.608, -14.188)
(5.608, -14.2)
(5.612, -14.2)
(5.612, -14.204)
(5.616, -14.204)
(5.616, -14.208)
(5.628, -14.208)
(5.628, -14.204)
(5.632, -14.204)
(5.632, -14.196)
(5.636, -14.196)
(5.636, -14.192)
(5.632, -14.192)
(5.632, -14.184)
(5.628, -14.184)
(5.628, -14.18)
(5.616, -14.18)
Centroide: (5.621314285714286, -14.194)

Polígono:
(5.608, -14.204)
(5.608, -14.208)
(5.612, -14.208)
(5.612, -14.204)
(5.608, -14.204)
Centroide: (5.61, -14.206)

Polígono:
(5.612, -14.204)
(5.612, -14.208)
(5.616, -14.208)
(5.616, -14.204)
(5.612, -14.204)
Centroide: (5.614, -14.206)

Polígono:
(5.632, -14.204)
(5.632, -14.208)
(5.636, -14.208)
(5.636, -14.204)
(5.632, -14.204)
Centroide: (5.634, -14.206)

Polígono:
(5.612, -14.208)
(5.612, -14.212)
(5.616, -14.212)
(5.616, -14.208)
(5.612, -14.208)
Centroide: (5.614, -14.21)

Polígono:
(0.0, 0.0)
(0.0, -15.36)
(8.64, -15.36)
(8.64, 0.0)
(0.0, 0.0)
Centroide: (4.319988758035658, -7.67997238578876)
"""

    # Leer el archivo generado
    with open(output_file_subidas, 'r') as archivo_salida:
        contenido_generado = archivo_salida.read()

    # Verificar que el contenido generado sea igual al esperado
    assert contenido_generado.strip() == contenido_esperado.strip(), "El contenido del archivo generado no coincide con el esperado."
